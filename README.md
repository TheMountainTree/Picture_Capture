# ROS 2 Multi-Camera Workspace

This workspace is designed for synchronized data capture, processing, and visualization using **Orbbec** and **Kinect2** cameras. It integrates camera drivers with custom tools for recording RGB-D data and performing post-processing tasks like Region of Interest (ROI) extraction.

## Project Structure

```
ros2_ws/
├── src/
│   ├── get_picture/       # Custom package for data capture & visualization
│   ├── kinect2_ros2/      # ROS 2 Driver for Kinect V2 (Bridge, Calibration, etc.)
│   └── OrbbecSDK_ROS2/    # ROS 2 Driver for Orbbec cameras (Gemini, Femto, etc.)
├── ROI.py                 # Post-processing script for Region of Interest extraction
├── data/                  # Default directory for storing captured data
└── README.md              # Project documentation
```

## Key Components

### 1. Data Capture (`src/get_picture`)
A custom ROS 2 package that provides nodes to:
- Capture RGB, Depth, and Point Cloud data from Orbbec and Kinect2 cameras.
- Save data locally on demand (supports single or dual camera modes).
- Visualize point clouds from both cameras simultaneously using Open3D.

**[Read detailed documentation](src/get_picture/README.md)**

### 2. Camera Drivers
- **Kinect2**: `kinect2_ros2` provides the bridge to interface with Kinect V2 sensors.
- **Orbbec**: `OrbbecSDK_ROS2` provides support for various Orbbec 3D cameras.

### 3. Post-Processing (`ROI.py`)
A utility script designed to segment specific objects (Region of Interest) from the captured point clouds.
- **How it works**: 
  1. Detects a chessboard pattern in the captured RGB image.
  2. Projects the 2D chessboard area into 3D space using camera intrinsics.
  3. Filters the Point Cloud to retain only the points corresponding to the chessboard area.
- **Usage**:
  ```bash
  python3 ROI.py
  ```
  It automatically processes `.ply` and `.png` files found in `data/orbbec` and `data/kinect2`, generating `*_roi.ply` files.

## Getting Started

### Prerequisites
- **ROS 2** (Humble, Foxy, or compatible distribution)
- **Python 3 Libraries**: `numpy`, `opencv-python`, `open3d`
- **Hardware**: Orbbec and/or Kinect2 cameras connected.

### Build
1. Clone the repository (if not already done).
2. Install dependencies (using `rosdep` is recommended).
3. Build the workspace:
   ```bash
   colcon build --symlink-install
   ```
4. Source the setup script:
   ```bash
   source install/setup.bash
   ```

### Usage Workflow

1. **Launch Drivers**: 
   Start the drivers for your connected cameras.
   - *Example for Orbbec*: `ros2 launch orbbec_camera gemini330_series.launch.py` (adjust for your model)
   - *Example for Kinect2*: `ros2 launch kinect2_bridge kinect2_bridge_launch.yaml`

2. **Capture Data**:
   Run the dual camera capture node:
   ```bash
   ros2 run get_picture DualCameraSaveNode.py
   ```
   - Press **`s`** in the preview window to save a snapshot from both cameras.
   - Data is saved to `data/orbbec/` and `data/kinect2/`.

3. **Process Data (ROI Extraction)**:
   After capturing, run the ROI script to extract the relevant point cloud sections:
   ```bash
   python3 ROI.py
   ```

## Data Management

Captured data is organized by camera in the `data/` directory:

- **`data/orbbec/`**: Contains Orbbec captures.
- **`data/kinect2/`**: Contains Kinect2 captures.

**File naming convention:**
- `*_color_*.png`: RGB Image
- `*_depth_*.png`: Raw Depth Image
- `*_cloud_*.ply`: Full Point Cloud
- `*_roi.ply`: Segmented Point Cloud (generated by `ROI.py`)
